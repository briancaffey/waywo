---
title: Pipeline
description: Column-by-column breakdown of the NDD pipeline that transforms tag seeds into full project records.
navigation.icon: i-lucide-workflow
---

# Pipeline Configuration

The pipeline is defined in `src/ndd_pipeline.py` and uses the NeMo Data Designer `DataDesignerConfigBuilder` API. Each column in the pipeline either samples a value or calls the LLM, with later columns referencing earlier ones via Jinja2 templates.

## Column Definitions

### Column 1: `primary_tag` (Sampler -- Category)

Picks one tag per row from the available tag pool.

- **With seed tags**: Samples uniformly from the user-provided tags
- **Without seed tags**: Samples from the full tag vocabulary in the database

```python
SamplerColumnConfig(
    name="primary_tag",
    sampler_type="category",
    params=CategorySamplerParams(values=primary_values),
)
```

### Column 2: `secondary_tags` (Sampler -- Subcategory)

Picks related tags based on real co-occurrence patterns in the database. For each `primary_tag` value, the pipeline precomputes which tags most frequently appear alongside it.

```python
SamplerColumnConfig(
    name="secondary_tags",
    sampler_type="subcategory",
    params=SubcategorySamplerParams(
        category="primary_tag",
        values=subcategory_map,  # { "ios": ["swift", "mobile", ...], ... }
    ),
)
```

**Tag co-occurrence** is computed by `build_tag_cooccurrence()`, which scans all existing projects and counts how often each pair of tags appears together. This grounds the generation in real patterns.

### Column 3: `target_audience` (Sampler -- Category)

Samples from a fixed list of 14 developer personas to add diversity:

- Indie hackers, enterprise developers, data scientists, students, open source contributors, startup founders, devops engineers, frontend/backend/mobile developers, security researchers, product managers, hobbyist programmers, creative technologists

### Column 4: `target_complexity` (Sampler -- Uniform)

A random integer from 1 to 10 that guides the LLM on how complex the project should be.

### Column 5: `project_idea` (LLM Text)

The core creative generation step. The LLM receives the sampled context and writes a 2--3 paragraph project idea.

When multiple seed tags are provided, the prompt includes all of them as required themes:

```
REQUIRED themes (combine ALL of these): nutrition, ios
Lead technology/domain: {{ primary_tag }}
Related technologies: {{ secondary_tags }}
Target audience: {{ target_audience }}
Target complexity: {{ target_complexity }}/10
```

**Model alias:** `waywo-creative` (temperature set to the user's creativity value, default 0.85)

### Column 6: `metadata` (LLM Structured)

Extracts structured fields from the free-text idea using Pydantic schema validation:

```python
class ProjectMetadata(BaseModel):
    title: str          # 2-5 word project name
    short_description: str  # 5-10 word tagline
    description: str    # 1-3 sentence description
    hashtags: list[str] # 3-5 lowercase hyphenated tags
```

**Model alias:** `waywo-structured` (temperature 0.1 for consistent extraction)

### Column 7: `idea_quality` (LLM Judge)

Scores each idea on two dimensions, each on a 1--10 scale with descriptive rubrics:

- **idea_score** -- Innovation, usefulness, and originality
- **complexity_score** -- Technical complexity and implementation difficulty

**Model alias:** `waywo-judge` (temperature 0.2)

### Columns 8--11: Expression Columns

Flatten the structured `metadata` output into individual columns for easier downstream processing:

```python
ExpressionColumnConfig(name="title", expr="{{ metadata.title }}")
ExpressionColumnConfig(name="short_description", expr="{{ metadata.short_description }}")
ExpressionColumnConfig(name="description", expr="{{ metadata.description }}")
ExpressionColumnConfig(name="hashtags", expr="{{ metadata.hashtags }}")
```

## Model Configuration

Three model aliases share the same LLM endpoint but use different temperatures:

| Alias | Temperature | Purpose |
|---|---|---|
| `waywo-creative` | User-configurable (0.1--1.5) | Idea generation |
| `waywo-structured` | 0.1 | Metadata extraction |
| `waywo-judge` | 0.2 | Quality scoring |

Models are configured in `src/ndd_config.py` using the same `LLM_BASE_URL`, `LLM_MODEL_NAME`, and `LLM_API_KEY` environment variables as the rest of the application.

## Tag Co-occurrence

The `build_tag_cooccurrence()` function in `src/ndd_pipeline.py` analyzes the existing project database to build a co-occurrence map:

```python
# For each tag, count how often every other tag appears alongside it
cooccurrence = {}
for project in projects:
    for tag in project.hashtags:
        for other_tag in project.hashtags:
            if other_tag != tag:
                cooccurrence[tag][other_tag] += 1
```

This map serves two purposes:
1. Provides realistic secondary tag suggestions for the sampler
2. Falls back to the most globally common tags when a seed tag has no co-occurrence data
